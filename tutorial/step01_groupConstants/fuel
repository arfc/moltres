% --- MSR cluster ------------------------------------------

set title "MSR2G-partially-enriched-U-full-core"

% --- get the stringer unit cell
include "unitCell.serp"

% --- problem materials
include "materials.serp"

% --- group structure
include "gentryGroups.serp"

% % --- Lattice

lat 300 1 2.54 2.54 30 30 5.08
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1


% --- Surfaces:

surf 3000  cyl 0.0 0.0 70.1675 % p. 78
surf 2999  cyl 0.0 0.0 70.485 % central mod -> core container : fuel
surf 2998  cyl 0.0 0.0 71.12 % core container ID -> OD : hastelloy
surf 2997  cyl 0.0 0.0 73.66 % vessel ID
surf 2996  cyl 0.0 0.0 75.08875 % vessel OD
surf 3001  pz  0
surf 3002  pz  198.12
surf 5000  pz  208.0
surf 5001  pz  -10.0

% control rod slots:
surf 2000 cyl  5.08  5.08 3
surf 2001 cyl -5.08  5.08 3
surf 2002 cyl -5.08 -5.08 3

% experiment slot
surf 2003 cyl  5.08 -5.08 3


% CR / experiment tubes
surf 1231 cyl 5.08 5.08 2.413 %1/20 inconel, approximate as hastelloy
surf 1232 cyl -5.08 5.08 2.413
surf 1233 cyl -5.08 -5.08 2.413
surf 1234 cyl 5.08 -5.08 2.413
surf 1235 cyl 5.08 5.08   2.54 %1/20 inconel, approximate as hastelloy
surf 1236 cyl -5.08 5.08  2.54
surf 1237 cyl -5.08 -5.08 2.54
surf 1238 cyl 5.08 -5.08  2.54

% top of control rods
surf 9000 pz 150.876

% CR surfaces
surf cr11 cyl 0 0 1.0033
surf cr12 cyl 0 0 1.0668
surf cr13 cyl 0 0 1.3716
surf cr14 cyl 0 0 1.4478

% --- Cells:
cell 300  0    fill 300  -3000 3001 -3002 2000 2001 2002 2003 % central mod
cell 401  0    fill 2    -2996 3002 -5000 2000 2001 2002 2003 % upper plenum
cell 402  0    fill 2    -2996 -3001 5001 % lower plenum

% CR cells
cell cr21 CR1 fill 6     -cr11       -9000 3001
cell cr31 CR2 fill 6     -cr11       -9000 3001
cell cr41 CR3 fill 6     -cr11       -9000 3001
cell cr22 CR1 fill 4      cr11 -cr12 -9000 3001
cell cr32 CR2 fill 4      cr11 -cr12 -9000 3001
cell cr42 CR3 fill 4      cr11 -cr12 -9000 3001
cell cr23 CR1 fill 5      cr12 -cr13 -9000 3001
cell cr33 CR2 fill 5      cr12 -cr13 -9000 3001
cell cr43 CR3 fill 5      cr12 -cr13 -9000 3001
cell cr24 CR1 fill 4      cr13 -cr14 -9000 3001
cell cr34 CR2 fill 4      cr13 -cr14 -9000 3001
cell cr44 CR3 fill 4      cr13 -cr14 -9000 3001
cell cr25 CR1 fill 6      cr14       -9000 3001
cell cr35 CR2 fill 6      cr14       -9000 3001
cell cr45 CR3 fill 6      cr14       -9000 3001
cell cr26 CR1 fill 6      9000
cell cr36 CR2 fill 6      9000
cell cr46 CR3 fill 6      9000
cell cr27 CR1 fill 6      -3001
cell cr37 CR2 fill 6      -3001
cell cr47 CR3 fill 6      -3001

% CONTROL ROD POSITIONS
% ordered like quadrants are
% 0 corresponds to bottom of moderator, but the poison is only 
% 59.4" long (p. 107, msre ops i). ie 150.876 cm
% so, the dropped rod for max worth is z-translated up 23.622 cm
% for a pulled rod, just move it out of the core. z=208.0 works well
trans CR1 5.08 5.08      208.0
trans CR2 -5.08 5.08     208.0
trans CR3 -5.08 -5.08    208.0

% approximate the experiment tube as a tube full of graphite
cell 710  0    fill 3   -1234 -5000 5001
cell 711  0    tank     1234 -1238 -5000 5001
cell 712  0    fill 2   1238 -2003  -5000 5001

% CR 1 guide tube
cell 1999 0    fill CR1 -1231 -5000 5001
cell 1998 0    fill 4 1231 -1235 -5000 5001
cell 1997 0    fill 2 1235 -2000 -5000 5001

% CR 2 guide tube
cell 1996 0    fill CR2 -1232 -5000 5001
cell 1995 0    fill 4 1232 -1236 -5000 5001
cell 1994 0    fill 2 1236 -2001 -5000 5001

% CR 3 guide tube
cell 1993 0    fill CR3 -1233 -5000 5001
cell 1992 0    fill 4 1233 -1237 -5000 5001
cell 1991 0    fill 2 1237 -2002 -5000 5001

% rest of the vessel + outside
cell 299  0    fill 2    3000 -2999 3001 -3002 % fuel around mod, between downcomer
cell 298  0    fill 4    2999 -2998 3001 -3002 % downcomer wall
cell 297  0    fill 2    2998 -2997 3001 -3002 % downcomer
cell 296  0    fill 4    2997 -2996 3001 -3002 % reactor vessel
cell 403  0    outside   -5001
cell 301  0    outside   2996 5001 -5000
cell 600  0    outside   5000

% --- Cross section data library file path:

set acelib "sss_endfb7u.xsdata"
set nfylib "sss_endfb7.nfy"
set declib "sss_endfb7.dec"

% --- group constant generation:

set gcu 2 3

% --- Neutron population and criticality cycles:

set pop 50000 600 100

% --- Geometry and mesh plots:

plot 1 1500 1500
plot 2 1500 1500
plot 3 1500 1500
mesh 1 1500 1500
mesh 2 1500 1500
mesh 3 1500 1500

% neutron spectrum measurement
ene eGrid 4 scale238
det spectralFuel dr 0  fuel  de eGrid
det spectralMod  dr 0  moder   de eGrid

% graphite is just at one temperature for this
therm grmod 922 grj2.18t  grj2.20t

trans u TR1 5.08 5.08 208.0
trans u TR2 5.08 5.08 161.9055
trans u TR3 5.08 5.08 115.811
trans u TR4 5.08 5.08 69.7165
trans u TR5 5.08 5.08 23.622 

% ----REST IN PEACE, CPUs ------------
branch fuel0 stp fuel -2.2818562220275704 633.0
branch fuel1 stp fuel -2.2496135461743254 700.0
branch fuel2 stp fuel -2.2023356233843003 800.0
branch fuel3 stp fuel -2.1560512943549197 900.0
branch fuel4 stp fuel -2.1107396777000536 1000.0
branch fuel5 stp fuel -2.066380330877196 1100.0
branch fuel6 stp fuel -2.022953240964719 1200.0
branch fuel7 stp fuel -1.9804388156329515 1300.0
branch fuel8 stp fuel -1.9388178743050104 1400.0
branch fuel9 stp fuel -1.8980716395033954 1500.0
branch fuel10 stp fuel -1.8581817283784454 1600.0
branch fuel11 stp fuel -1.819130144414831 1700.0
branch fuel12 stp fuel -1.7808992693123449 1800.0
branch fuel13 stp fuel -1.7434718550373258 1900.0
branch fuel14 stp fuel -1.7068310160411293 2000.0
branch rod0 tra CR1 TR1 
branch rod1 tra CR1 TR2 
branch rod2 tra CR1 TR3 
branch rod3 tra CR1 TR4 
branch rod4 tra CR1 TR5 

coef 1
0
15  fuel0 fuel1 fuel2 fuel3 fuel4 fuel5 fuel6 fuel7 fuel8 fuel9 fuel10 fuel11 fuel12 fuel13 fuel14 
5  rod0 rod1 rod2 rod3 rod4 
