<!DOCTYPE html><head><meta charset="UTF-8"><title>Theory and Methodology | Moltres</title><link href="../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/moltres.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Moltres</a><a href="https://github.com/arfc/moltres" class="right"><img src="../media/framework/github-logo.png" class="github-mark"></img><img src="../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="d7d951f6-97a2-43b9-bdeb-2e59562326f1" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="e628b2fb-de86-4e2b-b5ad-32a27b8ac548" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="bcfa8934-6a5e-4f1d-8d60-bf33878c9db2" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="91dce311-89fe-4490-82cd-99a912cea2cb"><i class="material-icons">menu</i></a><ul class="sidenav" id="91dce311-89fe-4490-82cd-99a912cea2cb"><li><a href="#!" class="dropdown-trigger" data-target="05569b90-379f-463b-b8ed-1bacfd6a3be2" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="0bcb87ae-a7b2-42d4-ba21-4aba2654c6fc" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="d21d09c5-7e71-45d0-a58f-2c3ae3b82202" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="d7d951f6-97a2-43b9-bdeb-2e59562326f1"><li><a href="installation.html">Install Moltres</a></li><li><a href="theory.html">Theory</a></li><li><a href="tutorials.html">Tutorials</a></li></ul><ul class="dropdown-content" id="e628b2fb-de86-4e2b-b5ad-32a27b8ac548"><li><a href="../syntax/index.html">Moltres Syntax</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Syntax</a></li><li><a href="../doxygen/classes.html">Moltres Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="../development/contributing.html">Contributing</a></li><li><a href="../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="bcfa8934-6a5e-4f1d-8d60-bf33878c9db2"><li><a href="https://github.com/arfc/moltres/discussions">Moltres Discussion Forum</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussion Forum</a></li></ul><ul class="dropdown-content" id="05569b90-379f-463b-b8ed-1bacfd6a3be2"><li><a href="installation.html">Install Moltres</a></li><li><a href="theory.html">Theory</a></li><li><a href="tutorials.html">Tutorials</a></li></ul><ul class="dropdown-content" id="0bcb87ae-a7b2-42d4-ba21-4aba2654c6fc"><li><a href="../syntax/index.html">Moltres Syntax</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Syntax</a></li><li><a href="../doxygen/classes.html">Moltres Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="../development/contributing.html">Contributing</a></li><li><a href="../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="d21d09c5-7e71-45d0-a58f-2c3ae3b82202"><li><a href="https://github.com/arfc/moltres/discussions">Moltres Discussion Forum</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussion Forum</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">getting_started</span><a href="#" class="breadcrumb">theory</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="52ffe7d1-81ce-4136-a56d-5e8237a38e92" data-section-level="1" data-section-text="Theory and Methodology"><h1 id="theory-and-methodology">Theory and Methodology</h1><p>The <em>two-step procedure</em> is a common approach for multiphysics full-core nuclear reactor analysis. These steps are:</p><p><strong>Step 1:</strong> Generate neutron group constant data with a lattice or full-core reactor model on a high-fidelity, continuous/fine-energy neutronics software at various reactor states.</p><p><strong>Step 2:</strong> Use an intermediate-fidelity, computationally cheaper neutronics software with the neutron group constant data to perform multiphysics reactor analysis.</p><p>Moltres falls under Step 2 of the two-step procedure. Moltres solves the conventional multigroup neutron diffusion and delayed neutron precursor equations. The precursor equations include precursor drift terms to account for precursor movement under molten salt flow. Moltres is built on the MOOSE finite element framework, enabling highly flexible and scalable reactor simulations.</p><section class="scrollspy" id="3452ec9c-cde6-4606-99e8-f4b781fd31e3" data-section-level="2" data-section-text="Multigroup Neutron Diffusion"><h2 id="multigroup-neutron-diffusion">Multigroup Neutron Diffusion</h2><p>The neutron diffusion equation is an approximation to the Boltzmann transport equation, and is derived by taking the zeroth and first moment with respect to <span class="moose-katex-inline-equation" id="moose-equation-582dffd4-e3e6-4b60-97f8-12745d72b81b"><script>var element = document.getElementById("moose-equation-582dffd4-e3e6-4b60-97f8-12745d72b81b");katex.render("\\hat\\Omega", element, {displayMode:false,throwOnError:false});</script></span>, the direction of neutron travel.  A full derivation of the diffusion equation will not be presented here for conciseness. Importantly, when taking the first moment of the transport equation the angular flux is assumed to be linearly anisotropic.  The approximations reduce the phase space through the elimination of angular dependence, but the resulting equation also has reduced fidelity when compared to the transport equation, particularly in regions where the neutron flux has strong angular dependence.  A non-exhaustive list of regions in which the neutron flux strongly depends on angle is near material interfaces between materials with highly dissimilar neutronic properties, within strong absorbers, and within near-void regions. As a deterministic method, the neutron diffusion method also requires discretization of the continuous energy dependence into energy groups consisting of non-overlapping, finite energy ranges across the entire energy spectrum.  This energy discretization creates a system of equations referred to as the multigroup neutron diffusion equations: </p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-8fd9ece3-8645-4e8e-be98-220aa295ccc2"></span><script>var element = document.getElementById("moose-equation-8fd9ece3-8645-4e8e-be98-220aa295ccc2");katex.render("\\frac{1}{v_g} \\frac{\\partial\\phi_g}{\\partial t}-\\nabla \\cdot D_g \\nabla \\phi_g +\\Sigma^R_{g} \\phi_g =\\sum^G_{g \\neq g'} {\\Sigma^s_{g'\\rightarrow g} \\phi_{g'}}+ \\chi^p_{g} \\sum^G_{g'=1} {\\left(1- \\beta \\right) \\nu_{g'} \\Sigma^f_{g'}\\phi_{g'} }+\\chi^d_{g} \\sum^I_i {\\lambda_i C_i}", element, {displayMode:true,throwOnError:false});</script></span><p>The delayed neutron precursor distributions are governed by:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-8edece5c-edaa-438d-af3b-c54dab3a184e"></span><script>var element = document.getElementById("moose-equation-8edece5c-edaa-438d-af3b-c54dab3a184e");katex.render("\\frac{\\partial C_i}{\\partial t}=\\sum^G_{g'=1}{\\beta_i \\nu \\Sigma^f_{g'}\\phi_{g'}}-\\lambda_i C_i-\\vec{u} \\cdot \\nabla C_i", element, {displayMode:true,throwOnError:false});</script></span><p>Notably, there are two production terms of neutrons, the prompt fission source and delayed neutron precursor decay source.  The first term describes the neutrons immediately born from fission, and the second term describes the neutrons born from the radioactive decay of neutron-emitting radionuclides, commonly called delayed neutron precursors.  The multigroup neutron diffusion equations are generally impossible to solve analytically for realistic problems and are therefore typically solved with numerical methods.  Moltres utilizes the <a href="https://mooseframework.inl.gov/help/faq/what_is_fem.html">Finite Element Method</a> (FEM) capabilities provided by the MOOSE framework.   In FEM, the spatial domain is discretized into finite mesh elements and the time dependence is modeled through discrete time steps and time integration methods. </p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Table 1: </span><span class="moose-caption-text" id="diff_table">Terms in multi-group neutron diffusion equation and their associated kernels</span></p><div form="['center', 'center', 'center']" recursive class="moose-table-div"><table><thead><tr><th style=";text-align:center">Term in Multi-Group Diffusion Equation</th><th style=";text-align:center">Associated Kernel</th><th style=";text-align:center">Definition of Term</th></tr></thead><tbody><tr><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-4addb3aa-5337-4d56-92c1-8c2f2722d160"><script>var element = document.getElementById("moose-equation-4addb3aa-5337-4d56-92c1-8c2f2722d160");katex.render("\\frac{1}{v_g} \\frac{\\partial\\phi_g}{\\partial t}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../source/kernels/NtTimeDerivative.html">NtTimeDerivative</a></td><td style=";text-align:center">Time rate of change of energy group g</td></tr></tbody><tbody><tr><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-bc30c49c-f8bb-44d2-8ff7-95deb333c60a"><script>var element = document.getElementById("moose-equation-bc30c49c-f8bb-44d2-8ff7-95deb333c60a");katex.render("- \\nabla \\cdot D_g \\nabla \\phi_g", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../source/kernels/GroupDiffusion.html">GroupDiffusion</a></td><td style=";text-align:center">Streaming term of energy group g</td></tr></tbody><tbody><tr><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-0760b5f6-482c-45b9-9268-add7635a6890"><script>var element = document.getElementById("moose-equation-0760b5f6-482c-45b9-9268-add7635a6890");katex.render("\\Sigma^R_{g} \\phi_g", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../source/kernels/SigmaR.html">SigmaR</a></td><td style=";text-align:center">Removal from energy group g</td></tr></tbody><tbody><tr><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-99b1516f-40ba-444e-a0cb-5c6018002281"><script>var element = document.getElementById("moose-equation-99b1516f-40ba-444e-a0cb-5c6018002281");katex.render("\\sum^G_{g \\neq g'} {\\Sigma^s_{g'\\rightarrow g} \\phi_{g'}}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../source/kernels/InScatter.html">InScatter</a></td><td style=";text-align:center">In-scattering into energy group g</td></tr></tbody><tbody><tr><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-7907a12f-7736-427a-a318-8b3b017c3f1c"><script>var element = document.getElementById("moose-equation-7907a12f-7736-427a-a318-8b3b017c3f1c");katex.render("\\chi^p_{g} \\sum^G_{g'=1} {\\left[1- \\beta \\right] \\nu_{g'} \\Sigma^f_{g'}\\phi_{g'} } ", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../source/kernels/CoupledFissionKernel.html">CoupledFissionKernel</a></td><td style=";text-align:center">Prompt fission neutron source</td></tr></tbody><tbody><tr><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-c970ada1-3519-4ff8-a230-48286dfb94e8"><script>var element = document.getElementById("moose-equation-c970ada1-3519-4ff8-a230-48286dfb94e8");katex.render("\\chi^d_{g} \\sum^I_i {\\lambda_i C_i}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../source/kernels/DelayedNeutronSource.html">DelayedNeutronSource</a></td><td style=";text-align:center">Delayed fission neutron source</td></tr></tbody></table></div></div></div><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Table 2: </span><span class="moose-caption-text" id="prec_table">Terms in delayed neutron precursor equation and their associated kernels</span></p><div form="['center', 'center', 'center']" recursive class="moose-table-div"><table><thead><tr><th style=";text-align:center">Term in Delayed Precursor Equation</th><th style=";text-align:center">Associated Kernel(s)</th><th style=";text-align:center">Definition of Term</th></tr></thead><tbody><tr><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-1fe83989-6d94-4677-8f78-2010178c0918"><script>var element = document.getElementById("moose-equation-1fe83989-6d94-4677-8f78-2010178c0918");katex.render("\\frac{\\partial C_i}{\\partial t}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../source/kernels/ScalarTransportTimeDerivative.html">ScalarTransportTimeDerivative</a></td><td style=";text-align:center">Time rate of change of precursor population</td></tr></tbody><tbody><tr><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-09c60c9e-312d-45b7-87ba-2670ed545097"><script>var element = document.getElementById("moose-equation-09c60c9e-312d-45b7-87ba-2670ed545097");katex.render("\\sum^G_{g'=1}{\\beta_i \\nu \\Sigma^f_{g'}\\phi_{g'}}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../source/kernels/PrecursorSource.html">PrecursorSource</a></td><td style=";text-align:center">Production of precursor from fission</td></tr></tbody><tbody><tr><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-5bff55b5-04e2-42d9-ba2a-0a899313b5e9"><script>var element = document.getElementById("moose-equation-5bff55b5-04e2-42d9-ba2a-0a899313b5e9");katex.render("-\\lambda_i C_i", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../source/kernels/PrecursorDecay.html">PrecursorDecay</a></td><td style=";text-align:center">Loss of precusors due to radioactive decay</td></tr></tbody><tbody><tr><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-e50f02ec-5b0c-4009-b9e1-ef85b000adf8"><script>var element = document.getElementById("moose-equation-e50f02ec-5b0c-4009-b9e1-ef85b000adf8");katex.render("-\\vec{u} \\cdot \\nabla C_i", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../source/dgkernels/DGCoupledAdvection.html">DGCoupledAdvection</a>, <a href="../source/dgkernels/DGFunctionConvection.html">DGFunctionConvection</a>, <a href="https://mooseframework.inl.gov/source/dgkernels/DGConvection.html">DGConvection</a></td><td style=";text-align:center">Advection of the precursors</td></tr></tbody></table></div></div></div><p>For the advective term in the delayed neutron precursor equation, <span class="moose-katex-inline-equation" id="moose-equation-874fcde7-f72f-4cab-9654-dc9a9c51020a"><script>var element = document.getElementById("moose-equation-874fcde7-f72f-4cab-9654-dc9a9c51020a");katex.render("-\\vec{u}\\cdot \\nabla C_i", element, {displayMode:false,throwOnError:false});</script></span>, there are three kernels. DGCoupledAdvection is used when the velocity is a variable in the simulation, DGFunctionConvection is used when the velocity is a function, and DGConvection is for when the velocity is constant.</p></section><section class="scrollspy" id="76e60d14-d939-4ac8-b1dd-a07cf94beb1c" data-section-level="2" data-section-text="Heat Transfer and Fluid Flow"><h2 id="heat-transfer-and-fluid-flow">Heat Transfer and Fluid Flow</h2><p>Moltres compiles with the MOOSE <a href="https://mooseframework.inl.gov/modules/navier_stokes/index.html">Navier-Stokes</a> and <a href="https://mooseframework.inl.gov/modules/heat_transfer/index.html">Heat Transfer</a> modules for flow modeling capabilities by default. Moltres couples with these modules natively because they are all built on the MOOSE framework.</p><p>Past work with Moltres have modeled incompressible salt flow and temperature advection-diffusion with the <a href="https://mooseframework.inl.gov/modules/navier_stokes/cgfe.html">INS or INSAD implementations</a> of the Navier-Stokes equations (<a href="#peterson_overview_2018">Peterson et al., 2018</a>). Coupling with the compressible or finite volume implementations within the Navier-Stokes module are likely possible, but have not been demonstrated yet.</p><p>For turbulence modeling, Moltres has a Spalart-Allmaras (SA) turbulence model (<a href="#spalart_one-equation_1992">Spalart and Allmaras, 1992</a>) implementation with streamline-upwind Petrov-Galerkin (SUPG) stabilization. On balance the SA model is a complete (does not require prior knowledge of the actual turbulence behavior) and computationally efficient turbulence model for approximating wall-bounded turbulent flows. The SA model implementation in Moltres is compatible with the INSAD implementation only. Additionally, Moltres contains turbulent diffusion physics kernels for temperature and the delayed neutron precursors.</p><p>The SA model in Moltres follows the (SA-noft2-R) implementation as described on the NASA <a href="https://turbmodels.larc.nasa.gov/spalart.html">Turbulence Modeling Resource</a> website. The <span class="moose-katex-inline-equation" id="moose-equation-3ba2a64a-77d4-4636-84e5-a85523873314"><script>var element = document.getElementById("moose-equation-3ba2a64a-77d4-4636-84e5-a85523873314");katex.render("f_{t2}", element, {displayMode:false,throwOnError:false});</script></span> term is togglable using the <code>use_ft2_term</code> input parameter (false by default). Moltres&#x27; implementation solves for the modified dynamic viscosity <span class="moose-katex-inline-equation" id="moose-equation-96a497af-c572-4164-bef8-c9ff6da5e5fa"><script>var element = document.getElementById("moose-equation-96a497af-c572-4164-bef8-c9ff6da5e5fa");katex.render("\\tilde{\\mu}", element, {displayMode:false,throwOnError:false});</script></span> which can be easily obtained using <span class="moose-katex-inline-equation" id="moose-equation-92ac7fdc-0965-43d7-ace7-13c16276385b"><script>var element = document.getElementById("moose-equation-92ac7fdc-0965-43d7-ace7-13c16276385b");katex.render("\\nu=mu/\\rho", element, {displayMode:false,throwOnError:false});</script></span> to convert <span class="moose-katex-inline-equation" id="moose-equation-8fb12bac-f85a-4a88-a581-596c69f3f47d"><script>var element = document.getElementById("moose-equation-8fb12bac-f85a-4a88-a581-596c69f3f47d");katex.render("\\nu", element, {displayMode:false,throwOnError:false});</script></span> to <span class="moose-katex-inline-equation" id="moose-equation-ee915e48-b448-48af-bdc4-ee9f67b29bd2"><script>var element = document.getElementById("moose-equation-ee915e48-b448-48af-bdc4-ee9f67b29bd2");katex.render("\\mu", element, {displayMode:false,throwOnError:false});</script></span> as follows:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-b99a023b-4625-4b66-a177-9d11ff290a5e"></span><span class="moose-katex-equation-number">(1)</span><script>var element = document.getElementById("moose-equation-b99a023b-4625-4b66-a177-9d11ff290a5e");katex.render("\\rho \\frac{\\partial\\tilde{\\mu}}{\\partial t} + \\rho \\mathbf{u}\\cdot\\nabla\\tilde{\\mu} = \\rho c_{b1} \\left(1-f_{t2}\\right)\\tilde{S}\\tilde{\\mu} + \\frac{1}{\\sigma}\\{\\nabla\\cdot\\left[\\left(\\mu+ \\tilde{\\mu}\\right)\\nabla\\tilde{\\mu}\\right] + c_{b2}|\\nabla\\tilde{\\mu}|^2\\} - \\left(c_{w1}f_w - \\frac{c_{b1}}{\\kappa^2}f_{t2}\\right)\\left( \\frac{\\tilde{\\mu}}{d}\\right)^2", element, {displayMode:true,throwOnError:false});</script></span><p>where</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-161b31b3-66f0-48e1-9061-08b459898175"></span><script>var element = document.getElementById("moose-equation-161b31b3-66f0-48e1-9061-08b459898175");katex.render("\\mu_t = \\tilde{\\mu}f_{v1} = \\text{turbulent eddy viscosity}, \\hspace{4cm} f_{v1} = \\frac{\\chi^3}{\\chi^3 + c_{v1}^3}, \\hspace{4cm} \\chi = \\frac{\\tilde{\\mu}}{\\mu}, \\hspace{2cm} \\\\ \\hspace{1cm} \\tilde{S} = \\Omega + \\frac{\\tilde{\\nu}}{\\kappa^2 d^2} f_{v2}, \\hspace{6cm} f_{v2} = 1 - \\frac{\\chi}{1+\\chi f_{v1}}, \\hspace{2cm} \\Omega = \\sqrt{2W_{ij}W_{ij}} = \\text{vorticity magnitude}, \\\\ W_{ij} = \\frac{1}{2}\\left(\\frac{\\partial u_i}{\\partial x_j} - \\frac{\\partial u_j}{\\partial x_i} \\right), \\hspace{5cm} f_w = g\\left(\\frac{1 + c_{w3}^6}{g^6 + c_{w3}^6}\\right)^{1/6}, \\hspace{3cm} g = r + c_{w2}\\left(r^6 - r\\right), \\\\ r = \\text{min}\\left(\\frac{\\tilde{\\nu}}{\\tilde{S}\\kappa^2d^2}, 10\\right), \\hspace{5cm} f_{t2} = c_{t3} \\exp{\\left(-c_{t4}\\chi^2\\right)}, \\hspace{6cm}", element, {displayMode:true,throwOnError:false});</script></span><p>and the constants are:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-6bd89818-4d75-445b-a8d6-844e29a4ebf7"></span><script>var element = document.getElementById("moose-equation-6bd89818-4d75-445b-a8d6-844e29a4ebf7");katex.render("\\sigma = \\frac{2}{3}, \\ c_{b1} = 0.1355, \\ c_{b2} = 0.622, \\ \\kappa = 0.41, \\ c_{w1} = \\frac{c_{b1}}{\\kappa^2} + \\frac{1+c_{b2}}{\\sigma}, \\ c_{w2} = 0.3, \\ c_{w3} = 2, \\ c_{v1} = 7.1, \\ c_{t3} = 1.2, \\ c_{t4} = 0.5 \\ \\text{.}", element, {displayMode:true,throwOnError:false});</script></span><p>We performed simple verification and validation tests of the SA model in Moltres using reference problems for channel, pipe, and backward-facing step flow. The Moltres test dataset is available on <a href="https://doi.org/10.5281/zenodo.10059649">Zenodo</a>. The following subsections show plots comparing results from Moltres to reference data from literature.</p><section id="f144a128-d0a4-4c6f-a9b0-4227301b5934" data-section-level="4" data-section-text="Turbulent Channel Flow Verification Test"><h4 id="turbulent-channel-flow-verification-test">Turbulent Channel Flow Verification Test</h4><p>The channel flow test is based on the direct numerical simulation (DNS) of turbulent channel flow with <span class="moose-katex-inline-equation" id="moose-equation-a8d90391-3726-42ac-89e5-3e8fcb4b212b"><script>var element = document.getElementById("moose-equation-a8d90391-3726-42ac-89e5-3e8fcb4b212b");katex.render("Re_\\tau\\approx395", element, {displayMode:false,throwOnError:false});</script></span> by <a href="#moser_direct_1999">Moser et al. (1999)</a>. The Moltres input file for this problem may be found in <code>moltres/problems/2023-basic-turbulence-cases/channel-flow/</code>.</p><div class="card moose-float" style="width:33%;padding:10px;float:left;" id="channel-vel"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/channel_vel.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text" id="channel-vel">Normalized velocity distribution across the channel.</span></p></div></div><div class="card moose-float" style="width:33%;padding:10px;float:left;" id="channel-nondim"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/channel_nondim.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 2: </span><span class="moose-caption-text" id="channel-nondim">Dimensionless velocity vs dimensionless wall distance.</span></p></div></div><div class="card moose-float" style="width:33%;padding:10px;float:left;" id="channel-stress"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/channel_stress.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 3: </span><span class="moose-caption-text" id="channel-stress">Normalized stress distribution across the channel.</span></p></div></div></section><section id="c34a57b6-9ccc-4aef-92f1-b0e424e39d2c" data-section-level="4" data-section-text="Turbulent Pipe Flow Validation Test"><h4 id="turbulent-pipe-flow-validation-test">Turbulent Pipe Flow Validation Test</h4><p>The pipe flow test is based on the turbulent pipe flow experiment with <span class="moose-katex-inline-equation" id="moose-equation-6cf843f6-e4b9-4f28-8900-418100f34047"><script>var element = document.getElementById("moose-equation-6cf843f6-e4b9-4f28-8900-418100f34047");katex.render("Re\\approx 40,000", element, {displayMode:false,throwOnError:false});</script></span> by <a href="#laufer_structure_1954">Laufer (1954)</a>. The Moltres input file for this problem may be found in <code>moltres/problems/2023-basic-turbulence-cases/pipe-flow/</code>.</p><div class="card moose-float" style="width:33%;padding:10px;float:left;" id="pipe-vel"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/pipe_vel.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 4: </span><span class="moose-caption-text" id="pipe-vel">Normalized velocity distribution across the pipe.</span></p></div></div><div class="card moose-float" style="width:33%;padding:10px;float:left;" id="pipe-nondim"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/pipe_nondim.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 5: </span><span class="moose-caption-text" id="pipe-nondim">Dimensionless velocity vs dimensionless wall distance.</span></p></div></div><div class="card moose-float" style="width:33%;padding:10px;float:left;" id="pipe-stress"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/pipe_stress.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 6: </span><span class="moose-caption-text" id="pipe-stress">Normalized turbulent shear stress distribution across the channel.</span></p></div></div></section><section id="3564771c-3b33-4902-a22f-25dab897bc44" data-section-level="4" data-section-text="Backward - Facing Step Flow Validation Test"><h4 id="backward-facing-step-flow-validation-test">Backward-Facing Step Flow Validation Test</h4><p>The backward-facing step (BFS) flow test is based on the BFS flow experiment with <span class="moose-katex-inline-equation" id="moose-equation-a2138ba0-872d-4abb-a3ef-0cc9771910ae"><script>var element = document.getElementById("moose-equation-a2138ba0-872d-4abb-a3ef-0cc9771910ae");katex.render("Re\\approx 36,000", element, {displayMode:false,throwOnError:false});</script></span> by <a href="#driver_features_1985">Driver and Seegmiller (1985)</a>. The Moltres input file for this problem may be found in <code>moltres/problems/2023-basic-turbulence-cases/pipe-flow/</code>. The SA model implementation in Moltres performs largely similarly to the reference SA model results provided on the <a href="https://turbmodels.larc.nasa.gov/spalart.html">Turbulence Modeling Resource</a> website.</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Table 3: </span><span class="moose-caption-text" id="re-table">Flow reattachment length estimates (normalized by step height <span class="moose-katex-inline-equation" id="moose-equation-eda565c5-958e-4903-91c7-7fdfb834ff9c"><script>var element = document.getElementById("moose-equation-eda565c5-958e-4903-91c7-7fdfb834ff9c");katex.render("H", element, {displayMode:false,throwOnError:false});</script></span>)</span></p><div form="['left', 'left', 'left']" recursive class="moose-table-div"><table><thead><tr><th style=";text-align:left">Reference experimental data</th><th style=";text-align:left">Reference SA model</th><th style=";text-align:left">Moltres</th></tr></thead><tbody><tr><td style=";text-align:left"><span class="moose-katex-inline-equation" id="moose-equation-4a9b1ab9-a4ce-468b-bd1d-a6680272d1e2"><script>var element = document.getElementById("moose-equation-4a9b1ab9-a4ce-468b-bd1d-a6680272d1e2");katex.render("6.26 \\pm 0.10", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:left"><span class="moose-katex-inline-equation" id="moose-equation-0e5b312a-caee-4a60-bafc-9aad67e0d05c"><script>var element = document.getElementById("moose-equation-0e5b312a-caee-4a60-bafc-9aad67e0d05c");katex.render("6.1", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:left"><span class="moose-katex-inline-equation" id="moose-equation-80a90b9c-3b52-4ec3-b7c1-1d2edfd58cba"><script>var element = document.getElementById("moose-equation-80a90b9c-3b52-4ec3-b7c1-1d2edfd58cba");katex.render("6.36", element, {displayMode:false,throwOnError:false});</script></span></td></tr></tbody></table></div></div></div><div class="card moose-float" style="width:33%;padding:10px;float:left;" id="bfs-upstream-vel"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/bfs_upstream_vel.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 7: </span><span class="moose-caption-text" id="bfs-upstream-vel">Normalized velocity distribution at <span class="moose-katex-inline-equation" id="moose-equation-a465c224-a9a6-4d06-afa2-0ceb25b11d32"><script>var element = document.getElementById("moose-equation-a465c224-a9a6-4d06-afa2-0ceb25b11d32");katex.render("x/H", element, {displayMode:false,throwOnError:false});</script></span> equal -4 (upstream of step).</span></p></div></div><div class="card moose-float" style="width:33%;padding:10px;float:left;" id="bfs-downstream-vel"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/bfs_downstream_vel.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 8: </span><span class="moose-caption-text" id="bfs-downstream-vel">Normalized velocity distribution at various <span class="moose-katex-inline-equation" id="moose-equation-70766b33-5f63-445a-a395-e405d832df36"><script>var element = document.getElementById("moose-equation-70766b33-5f63-445a-a395-e405d832df36");katex.render("x/H", element, {displayMode:false,throwOnError:false});</script></span> locations (downstream of step).</span></p></div></div><div class="card moose-float" style="width:33%;padding:10px;float:left;" id="bfs-cf"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/bfs_cf.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 9: </span><span class="moose-caption-text" id="bfs-cf">Skin friction coefficient along the bottom wall.</span></p></div></div><div class="card moose-float" style="width:33%;padding:10px;margin-left:17%;float:left;" id="bfs-cp"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/bfs_cp.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 10: </span><span class="moose-caption-text" id="bfs-cp">Skin pressure coefficient along the bottom wall.</span></p></div></div><div class="card moose-float" style="width:33%;padding:10px;margin-right:17%;float:left;" id="bfs-stress"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/bfs_stress.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 11: </span><span class="moose-caption-text" id="bfs-stress">Normalized turbulent shear stress distribution at various <span class="moose-katex-inline-equation" id="moose-equation-e39058be-aa9a-4713-9375-f89e92785969"><script>var element = document.getElementById("moose-equation-e39058be-aa9a-4713-9375-f89e92785969");katex.render("x/H", element, {displayMode:false,throwOnError:false});</script></span> locations        (downstream of step).</span></p></div></div><div class="card moose-float" style="width:80%;float:left;margin-left:10%;margin-right:10%;" id="bfs"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/bfs.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 12: </span><span class="moose-caption-text" id="bfs">Close-up of the velocity magnitude and streamlines around the backward-facing step</span></p></div></div></section></section><section class="scrollspy" id="189c3c64-892a-40b0-8a88-3da0f586d218" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="driver_features_1985">David&nbsp;M. Driver and H.&nbsp;Lee Seegmiller.
Features of a reattaching turbulent shear layer in divergent channelflow.
<em>AIAA Journal</em>, 23(2):163–171, February 1985.
URL: <a href="https://arc.aiaa.org/doi/10.2514/3.8890">https://arc.aiaa.org/doi/10.2514/3.8890</a> (visited on 2022-01-17), <a href="https://doi.org/10.2514/3.8890">doi:10.2514/3.8890</a>.<a href="#31d0ea6c-a74c-4ab2-a5d1-85b6d1616fe9" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="31d0ea6c-a74c-4ab2-a5d1-85b6d1616fe9"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{driver_features_1985,
    author = "Driver, David M. and Seegmiller, H. Lee",
    title = "Features of a reattaching turbulent shear layer in divergent channelflow",
    volume = "23",
    issn = "0001-1452, 1533-385X",
    url = "https://arc.aiaa.org/doi/10.2514/3.8890",
    doi = "10.2514/3.8890",
    language = "en",
    number = "2",
    urldate = "2022-01-17",
    journal = "AIAA Journal",
    month = "February",
    year = "1985",
    pages = "163--171",
    file = "Driver and Seegmiller - 1985 - Features of a reattaching turbulent shear layer in.pdf:C\:\\Users\\Sun Myung\\Zotero\\storage\\PHD7NPMR\\Driver and Seegmiller - 1985 - Features of a reattaching turbulent shear layer in.pdf:application/pdf"
}
</code></pre></div></div></li><li id="laufer_structure_1954">John Laufer.
The structure of turbulence in fully developed pipe flow.
Technical Report, National Bureau of Standards, January 1954.
NTRS Author Affiliations: NTRS Report/Patent Number: NACA-TR-1174 NTRS Document ID: 19930092199 NTRS Research Center: Legacy CDMS (CDMS).
URL: <a href="https://ntrs.nasa.gov/citations/19930092199">https://ntrs.nasa.gov/citations/19930092199</a> (visited on 2023-10-30).<a href="#abe1d608-7d7b-4382-b310-333f6d4af3d5" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="abe1d608-7d7b-4382-b310-333f6d4af3d5"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@techreport{laufer_structure_1954,
    author = "Laufer, John",
    title = "The structure of turbulence in fully developed pipe flow",
    url = "https://ntrs.nasa.gov/citations/19930092199",
    abstract = "Measurements, principally with a hot-wire anemometer, were made in fully developed turbulent flow in a 10-inch pipe at speeds of approximately 10 and 100 feet per second. Emphasis was placed on turbulence and conditions near the wall. The results include relevant mean and statistical quantities, such as Reynolds stresses, triple correlations, turbulent dissipation, and energy spectra. It is shown that rates of turbulent-energy production, dissipation, and diffusion have sharp maximums near the edge of the laminar sublayer and that there exist a strong movement of kinetic energy away from this point and an equally strong movement of pressure energy toward it.",
    urldate = "2023-10-30",
    institution = "National Bureau of Standards",
    month = "January",
    year = "1954",
    note = "NTRS Author Affiliations: NTRS Report/Patent Number: NACA-TR-1174 NTRS Document ID: 19930092199 NTRS Research Center: Legacy CDMS (CDMS)",
    file = "19930092199.pdf:C\:\\Users\\Sun Myung\\Zotero\\storage\\L8SHCFP9\\Laufer - 1954 - The structure of turbulence in fully developed pip.pdf:application/pdf;Snapshot:C\:\\Users\\Sun Myung\\Zotero\\storage\\7U6SXNMA\\19930092199.html:text/html"
}
</code></pre></div></div></li><li id="moser_direct_1999">Robert&nbsp;D. Moser, John Kim, and Nagi&nbsp;N. Mansour.
Direct numerical simulation of turbulent channel flow up to <span class="bibtex-protected">Reτ</span>=590.
<em>Physics of Fluids</em>, 11(4):943–945, April 1999.
URL: <a href="https://doi.org/10.1063/1.869966">https://doi.org/10.1063/1.869966</a> (visited on 2023-10-30), <a href="https://doi.org/10.1063/1.869966">doi:10.1063/1.869966</a>.<a href="#b26985db-81fc-4bfc-ad19-0fa093e3fd31" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="b26985db-81fc-4bfc-ad19-0fa093e3fd31"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{moser_direct_1999,
    author = "Moser, Robert D. and Kim, John and Mansour, Nagi N.",
    title = "Direct numerical simulation of turbulent channel flow up to {Reτ}=590",
    volume = "11",
    issn = "1070-6631",
    url = "https://doi.org/10.1063/1.869966",
    doi = "10.1063/1.869966",
    abstract = "Numerical simulations of fully developed turbulent channel flow at three Reynolds numbers up to Reτ=590 are reported. It is noted that the higher Reynolds number simulations exhibit fewer low Reynolds number effects than previous simulations at Reτ=180. A comprehensive set of statistics gathered from the simulations is available on the web at http://www.tam.uiuc.edu/Faculty/Moser/channel.",
    number = "4",
    urldate = "2023-10-30",
    journal = "Physics of Fluids",
    month = "April",
    year = "1999",
    pages = "943--945",
    file = "Full Text PDF:C\:\\Users\\Sun Myung\\Zotero\\storage\\R6IZTYHZ\\Moser et al. - 1999 - Direct numerical simulation of turbulent channel f.pdf:application/pdf;Snapshot:C\:\\Users\\Sun Myung\\Zotero\\storage\\NN9Z4VLF\\Direct-numerical-simulation-of-turbulent-channel.html:text/html"
}
</code></pre></div></div></li><li id="peterson_overview_2018">John Peterson, Alexander Lindsay, and Fande Kong.
Overview of the <span class="bibtex-protected">Incompressible</span> <span class="bibtex-protected">Navier</span>-<span class="bibtex-protected">Stokes</span> simulation capabilities in the <span class="bibtex-protected">MOOSE</span> <span class="bibtex-protected">Framework</span>.
<em>Advances in Engineering Software</em>, 119:68–92, May 2018.
<a href="https://doi.org/10.1016/j.advengsoft.2018.02.004">doi:10.1016/j.advengsoft.2018.02.004</a>.<a href="#d7f54cae-95e7-4d96-b7f4-6d393659228f" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="d7f54cae-95e7-4d96-b7f4-6d393659228f"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{peterson_overview_2018,
    author = "Peterson, John and Lindsay, Alexander and Kong, Fande",
    title = "Overview of the {Incompressible} {Navier}-{Stokes} simulation capabilities in the {MOOSE} {Framework}",
    volume = "119",
    doi = "10.1016/j.advengsoft.2018.02.004",
    abstract = {The Multiphysics Object Oriented Simulation Environment (MOOSE) framework is a high-performance, open source, C++ finite element toolkit developed at Idaho National Laboratory. MOOSE was created with the aim of assisting domain scientists and engineers in creating customizable, high-quality tools for multiphysics simulations. While the core MOOSE framework itself does not contain code for simulating any particular physical application, it is distributed with a number of physics "modules" which are tailored to solving e.g. heat conduction, phase field, and solid/fluid mechanics problems. In this report, we describe the basic equations, finite element formulations, software implementation, and regression/verification tests currently available in MOOSE's navier\\_stokes module for solving the Incompressible Navier-Stokes (INS) equations.},
    journal = "Advances in Engineering Software",
    month = "May",
    year = "2018",
    keywords = "65N30, Mathematics - Numerical Analysis",
    pages = "68--92",
    file = "arXiv\:1710.08898 PDF:C\:\\Users\\Sun Myung\\Zotero\\storage\\PBHHJKCD\\Peterson et al. - 2017 - Overview of the Incompressible Navier-Stokes simul.pdf:application/pdf;arXiv.org Snapshot:C\:\\Users\\Sun Myung\\Zotero\\storage\\3RRL7ED2\\1710.html:text/html;Full Text PDF:C\:\\Users\\Sun Myung\\Zotero\\storage\\YGQ9TDMU\\Peterson et al. - 2018 - Overview of the Incompressible Navier-Stokes simul.pdf:application/pdf"
}
</code></pre></div></div></li><li id="spalart_one-equation_1992">P.&nbsp;Spalart and S.&nbsp;Allmaras.
A one-equation turbulence model for aerodynamic flows.
In <em>30th <span class="bibtex-protected">Aerospace</span> <span class="bibtex-protected">Sciences</span> <span class="bibtex-protected">Meeting</span> and <span class="bibtex-protected">Exhibit</span></em>. American Institute of Aeronautics and Astronautics, January 1992.
_eprint: https://arc.aiaa.org/doi/pdf/10.2514/6.1992-439.
URL: <a href="https://arc.aiaa.org/doi/abs/10.2514/6.1992-439">https://arc.aiaa.org/doi/abs/10.2514/6.1992-439</a> (visited on 2023-11-02), <a href="https://doi.org/10.2514/6.1992-439">doi:10.2514/6.1992-439</a>.<a href="#c113b5f8-0c26-4ee4-8fb5-6d18db06814b" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="c113b5f8-0c26-4ee4-8fb5-6d18db06814b"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@inproceedings{spalart_one-equation_1992,
    author = "Spalart, P. and Allmaras, S.",
    title = "A one-equation turbulence model for aerodynamic flows",
    url = "https://arc.aiaa.org/doi/abs/10.2514/6.1992-439",
    urldate = "2023-11-02",
    booktitle = "30th {Aerospace} {Sciences} {Meeting} and {Exhibit}",
    publisher = "American Institute of Aeronautics and Astronautics",
    month = "January",
    year = "1992",
    doi = "10.2514/6.1992-439",
    note = "\\_eprint: https://arc.aiaa.org/doi/pdf/10.2514/6.1992-439"
}
</code></pre></div></div></li></ol></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#3452ec9c-cde6-4606-99e8-f4b781fd31e3" class="tooltipped" data-position="left" data-tooltip="Multigroup Neutron Diffusion">Multigroup Neutron Diffusion</a></li><li><a href="#76e60d14-d939-4ac8-b1dd-a07cf94beb1c" class="tooltipped" data-position="left" data-tooltip="Heat Transfer and Fluid Flow">Heat Transfer and Fluid Flow</a></li><li><a href="#189c3c64-892a-40b0-8a88-3da0f586d218" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../js/init.js"></script><script type="text/javascript" src="../js/navigation.js"></script><script type="text/javascript" src="../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../js/search_index.js"></script><script type="text/javascript" src="../js/sqa_moose.js"></script>