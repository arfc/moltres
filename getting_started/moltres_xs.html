<!DOCTYPE html><head><meta charset="UTF-8"><title>Group Constant File Generation With | Moltres</title><link href="../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/moltres.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Moltres</a><a href="https://github.com/arfc/moltres" class="right"><img src="../media/framework/github-logo.png" class="github-mark"></img><img src="../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="b9d0a362-352e-448b-b2c0-98d9a642bd6f" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="be2cb28a-aa4b-49c0-8b37-2c8309776151" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="ac9e2d5d-5ecf-4dd4-b759-a3c1ffee3e80" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="65fda648-47fe-4140-9fa7-86d97059eeb0"><i class="material-icons">menu</i></a><ul class="sidenav" id="65fda648-47fe-4140-9fa7-86d97059eeb0"><li><a href="#!" class="dropdown-trigger" data-target="16d6b4db-dc14-4387-9a1d-a17c4508d19a" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="6542312e-c875-490b-820f-b5f3a5d9d151" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="17dde92b-22fe-49f7-930c-d8a257a80103" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="b9d0a362-352e-448b-b2c0-98d9a642bd6f"><li><a href="installation.html">Install Moltres</a></li><li><a href="theory.html">Theory</a></li><li><a href="tutorials.html">Tutorials</a></li></ul><ul class="dropdown-content" id="be2cb28a-aa4b-49c0-8b37-2c8309776151"><li><a href="../syntax/index.html">Moltres Syntax</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Syntax</a></li><li><a href="../doxygen/classes.html">Moltres Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="../development/contributing.html">Contributing</a></li><li><a href="../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="ac9e2d5d-5ecf-4dd4-b759-a3c1ffee3e80"><li><a href="https://github.com/arfc/moltres/discussions">Moltres Discussion Forum</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussion Forum</a></li></ul><ul class="dropdown-content" id="16d6b4db-dc14-4387-9a1d-a17c4508d19a"><li><a href="installation.html">Install Moltres</a></li><li><a href="theory.html">Theory</a></li><li><a href="tutorials.html">Tutorials</a></li></ul><ul class="dropdown-content" id="6542312e-c875-490b-820f-b5f3a5d9d151"><li><a href="../syntax/index.html">Moltres Syntax</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Syntax</a></li><li><a href="../doxygen/classes.html">Moltres Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="../development/contributing.html">Contributing</a></li><li><a href="../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="17dde92b-22fe-49f7-930c-d8a257a80103"><li><a href="https://github.com/arfc/moltres/discussions">Moltres Discussion Forum</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussion Forum</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">getting_started</span><a href="#" class="breadcrumb">moltres_xs</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="93f38fc1-ec21-4739-9290-7b1e2b09a22c" data-section-level="1" data-section-text="Group Constant File Generation With moltres_xs.py"><h1 id="group-constant-file-generation-with">Group Constant File Generation With <code>moltres_xs.py</code></h1><section class="scrollspy" id="90652df7-59c3-4e47-a29f-352e5b44c1a2" data-section-level="2" data-section-text="Example problem : Godiva Sphere"><h2 id="example-problem-godiva-sphere">Example problem: Godiva Sphere</h2><p>In this tutorial, we demonstrate how to use OpenMC to generate group constants for Moltres using <code>moltres_xs.py</code>.</p><p>The relevant files for this tutorial may be found in the <a href="https://github.com/arfc/moltres/tree/devel/tutorial/"><code>godiva</code></a> tutorial directory. To run these input files and subsequent group constant generation scripts, the user must install <a href="https://github.com/openmc-dev/openmc/">OpenMC</a> version 0.13.2 or later.</p><section id="3670b56a-91f5-4d8c-bd65-85dcb39dd67d" data-section-level="3" data-section-text="Step 1 : Generating Group Constants with OpenMC"><h3 id="step-1-generating-group-constants-with-openmc">Step 1: Generating Group Constants with OpenMC</h3><p>In this directory, there are 2 OpenMC input files for 900K and 1200K simulations: <code>godiva_openmc_900.py</code> and <code>godiva_openmc_1200.py</code>. Unlike Scale or Serpent, OpenMC does not have a notion of branches to generate group constants for different temperatures and burnups. Thus, separate input files for different temperatures is required.</p><p>The user must include the <code>openmc_xs.generate_openmc_tallies_xml()</code> function in the OpenMC input file to generate a <code>domain_dict</code>. The function sets up the OpenMC tallies required for the group constant generation. This is necessary because unlike Serpent, OpenMC does not generate all the group constant data with any simulation, the user must specify what they want. The user may define domains as either openmc.Material or openmc.Cell.</p><p>For this tutorial, we also provide the OpenMC output files obtained after running the input files: <code>statepoint_900_openmc.100.h5</code>, <code>statepoint_1200_openmc.100.h5</code>, <code>summary_900.h5</code>, and <code>summary_1200.h5</code>. Each OpenMC simulation generates a statepoint and summary file. Both output files are required for the group constant generation.</p></section><section id="ec2ded5c-0203-4fb0-9488-e163ed32086f" data-section-level="3" data-section-text="Step 2 : Parsing OpenMC Output Files with moltres _ xs . py"><h3 id="step-2-parsing-openmc-output-files-with-moltres-xs-py">Step 2: Parsing OpenMC Output Files with moltres_xs.py</h3><p><code>godiva_openmc.inp</code> is the input file that informs <code>moltres_xs.py</code> how to parse the various OpenMC output files to generate Moltres group constants. The structure of the input file is as follows:</p><pre class="moose-pre"><code class="language-text">
[TITLE]
  *name of output json file*

[MAT]
  *number of materials*
  *names of materials listed*

[BRANCH]
  *number of branches*
  *material name* *temperature* *file index* *burnup index* *universe index* *branch index*
  
[FILES]
  *number of files*
  *statepoint file name* *openmc* *openmc input file* *summary file*
</code></pre><p>For OpenMC, since we do not utilize the burnup and branch indexes, users must indicate both index values as &quot;1&quot; so that <code>moltres_xs.py</code> correctly parses the input file. For OpenMC, we also add additional openmc input files and summary files. The universe index must correspond to the material or cell id defined in the OpenMC input file.</p><p>To generate the Moltres group constants, the user runs: <code></code>` python ../../python/moltres_xs.py godiva_openmc.inp <code></code>` This will output <code>godiva_openmc.json</code> containing the Moltres group constants. An example of this output file can be found in <code>../../python/test/gold/godiva.json</code>.</p></section></section><section class="scrollspy" id="c5279a86-2985-4d55-8f3d-8b09bd3d64df" data-section-level="2" data-section-text="OpenMC Group Constant Generation"><h2 id="openmc-group-constant-generation">OpenMC Group Constant Generation</h2><p>This table outlines the OpenMC methods used by <code>moltres_xs.py</code> to calculate the group constants for Moltres.</p><div form="['center', 'center', 'center', 'center']" recursive class="moose-table-div"><table><thead><tr><th style=";text-align:center">Group Constant</th><th style=";text-align:center">Description</th><th style=";text-align:center">OpenMC Tally Used</th><th style=";text-align:center">Units</th></tr></thead><tbody><tr><td style=";text-align:center">BETA_EFF</td><td style=";text-align:center">Delayed neutron fraction</td><td style=";text-align:center">mgxs.Beta()</td><td style=";text-align:center">-</td></tr></tbody><tbody><tr><td style=";text-align:center">CHI_T</td><td style=";text-align:center">Fission spectrum (total)</td><td style=";text-align:center">mgxs.Chi()</td><td style=";text-align:center">-</td></tr></tbody><tbody><tr><td style=";text-align:center">CHI_P</td><td style=";text-align:center">Fission spectrum (prompt neutrons)</td><td style=";text-align:center">mgxs.Chi(prompt=True)</td><td style=";text-align:center">-</td></tr></tbody><tbody><tr><td style=";text-align:center">CHI_D</td><td style=";text-align:center">Fission spectrum (delayed neutrons)</td><td style=";text-align:center">mgxs.ChiDelayed()</td><td style=";text-align:center">-</td></tr></tbody><tbody><tr><td style=";text-align:center">DECAY_CONSTANT</td><td style=";text-align:center">Decay rate for delayed neutron precursors</td><td style=";text-align:center">mgxs.DecayRate()</td><td style=";text-align:center">1/s</td></tr></tbody><tbody><tr><td style=";text-align:center">DIFFCOEF</td><td style=";text-align:center">Diffusion coefficient multi-group cross section</td><td style=";text-align:center">mgxs.DiffusionCoefficient()</td><td style=";text-align:center">cm</td></tr></tbody><tbody><tr><td style=";text-align:center">FISSE</td><td style=";text-align:center">Average deposited fission energy</td><td style=";text-align:center">mgxs.KappaFissionXS() / mgxs.FissionXS()</td><td style=";text-align:center">MeV</td></tr></tbody><tbody><tr><td style=";text-align:center">FISSXS</td><td style=";text-align:center">Fission cross section</td><td style=";text-align:center">mgxs.FissionXS()</td><td style=";text-align:center">1/cm</td></tr></tbody><tbody><tr><td style=";text-align:center">GTRANSFXS</td><td style=";text-align:center">Scattering production XS Matrix</td><td style=";text-align:center">mgxs.ScatterProbabilityMatrix() * mgxs.ScatterXS()</td><td style=";text-align:center">1/cm</td></tr></tbody><tbody><tr><td style=";text-align:center">NSF</td><td style=";text-align:center">Fission neutron production cross section</td><td style=";text-align:center">nu-fission / flux</td><td style=";text-align:center">1/cm</td></tr></tbody><tbody><tr><td style=";text-align:center">RECIPVEL</td><td style=";text-align:center">Inverse neutron speed</td><td style=";text-align:center">mgxs.InverseVelocity()</td><td style=";text-align:center">s/cm</td></tr></tbody><tbody><tr><td style=";text-align:center">REMXS</td><td style=";text-align:center">Removal cross section (out scatter + absorption)</td><td style=";text-align:center">mgxs.ScatterProbabilityMatrix() *  mgxs.ScatterXS() + mgxs.AbsorptionXS()</td><td style=";text-align:center">1/cm</td></tr></tbody></table></div></section><section class="scrollspy" id="83ff4b02-a22a-4d58-8fc0-008863939237" data-section-level="2" data-section-text="Serpent Comparison"><h2 id="serpent-comparison">Serpent Comparison</h2><p>We cross verified the group constants generated by OpenMC with group constants generated by Serpent. <code>godiva_serpent</code> and <code>godiva_serpent_res.m</code> are the Serpent input and output files for the Godiva sphere. <code>godiva_serpent.inp</code> generates the group constants with <code>moltres_xs.py</code>. Note the minor differences between <code>godiva_openmc.inp</code> and <code>godiva_serpent.inp</code> arising from the use of <code>branch</code> and <code>coef</code> cards to set up various reactor states at various temperatures in <a href="https://serpent.vtt.fi/mediawiki/index.php/Input_syntax_manual">Serpent</a>. Serpent condenses multi-temperature group constant data from the various branches into one <code>*_res.m</code> output file.</p><p>The only difference in syntax format for Serpent-based <code>*.inp</code> files lies in the <code>[FILES]</code> section as follows:</p><pre class="moose-pre"><code class="language-text">
[FILES]
  *number of files*
  *serpent _res.m file name* *serpent*
</code></pre><p>The group constant values generated by both Serpent and OpenMC are similar in values and orders of magnitude. The only notable difference is in the FISSE group constant value. Serpent outputs FISSE values of ~193 MeV, while OpenMC outputs FISSE values of ~202 MeV. A possible reason for this discrepancy is that Serpent includes neutrino energies while OpenMC does not. </p></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#90652df7-59c3-4e47-a29f-352e5b44c1a2" class="tooltipped" data-position="left" data-tooltip="Example problem : Godiva Sphere">Example problem : Godiva Sphere</a></li><li><a href="#c5279a86-2985-4d55-8f3d-8b09bd3d64df" class="tooltipped" data-position="left" data-tooltip="OpenMC Group Constant Generation">OpenMC Group Constant Generation</a></li><li><a href="#83ff4b02-a22a-4d58-8fc0-008863939237" class="tooltipped" data-position="left" data-tooltip="Serpent Comparison">Serpent Comparison</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../js/init.js"></script><script type="text/javascript" src="../js/navigation.js"></script><script type="text/javascript" src="../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../js/search_index.js"></script><script type="text/javascript" src="../js/sqa_moose.js"></script>